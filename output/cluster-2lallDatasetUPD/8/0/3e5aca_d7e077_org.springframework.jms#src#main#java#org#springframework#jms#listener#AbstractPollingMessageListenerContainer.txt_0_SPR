d7e077
@@ -353,3 +353,3 @@
 				// Nevertheless call commit, in order to reset the transaction timeout (if any).
-				commitIfNecessary(session, message);
+				commitIfNecessary(sessionToUse, message);
 				// Indicate that no message has been received.
